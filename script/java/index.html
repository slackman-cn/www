<!DOCTYPE html>
<html lang="en">
    <head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Document</title>
        <link rel="shortcut icon" href="../../img/linux.ico">
        <link href="../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../css/fontawesome.min.css" rel="stylesheet">
        <link href="../../css/brands.min.css" rel="stylesheet">
        <link href="../../css/solid.min.css" rel="stylesheet">
        <link href="../../css/v4-font-face.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-success">
            <div class="container">
                <a class="navbar-brand" href="../..">SLACKMAN.CN</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar-collapse" aria-controls="navbar-collapse" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="nav-item">
                                <a href="../.." class="nav-link"></a>
                            </li>
                            <li class="nav-item">
                                <a href="../../linux/" class="nav-link">Linux</a>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">Distro</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../distro/archlinux/" class="dropdown-item">ArchLinux from Scratch</a>
</li>
                                    
<li>
    <a href="../../distro/centos/" class="dropdown-item">CentOS</a>
</li>
                                    
<li>
    <a href="../../distro/ubuntu/" class="dropdown-item">Ubuntu</a>
</li>
                                    
<li>
    <a href="../../distro/~nanolinux/" class="dropdown-item">NanoLinux</a>
</li>
                                    
<li>
    <a href="../../distro/~tinylinux/" class="dropdown-item">TinyLinux</a>
</li>
                                    
<li>
    <a href="../../distro/~toolchain/" class="dropdown-item">Toolchain</a>
</li>
                                </ul>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">Howto</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../howto/artifact/" class="dropdown-item">制品库</a>
</li>
                                    
<li>
    <a href="../../howto/docs/" class="dropdown-item">文档库</a>
</li>
                                    
<li>
    <a href="../../howto/git/" class="dropdown-item">代码库</a>
</li>
                                    
<li>
    <a href="../../howto/make-ninja/" class="dropdown-item">构建工具 ninja</a>
</li>
                                    
<li>
    <a href="../../howto/make-scons/" class="dropdown-item">构建工具 scons</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Ustb</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../howto/ustb/" class="dropdown-item">USTB</a>
</li>
            
<li>
    <a href="../../howto/ustb/vt/" class="dropdown-item">VT</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle active" aria-current="page" role="button" data-bs-toggle="dropdown"  aria-expanded="false">Script</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../cxx/" class="dropdown-item">C,C++</a>
</li>
                                    
<li>
    <a href="../groovy/" class="dropdown-item">Groovy Script</a>
</li>
                                    
<li>
    <a href="./" class="dropdown-item active" aria-current="page">JAVA</a>
</li>
                                    
<li>
    <a href="../java_lib/" class="dropdown-item">JAVA Lib</a>
</li>
                                    
<li>
    <a href="../java_native_access/" class="dropdown-item">JAVA Native Access</a>
</li>
                                    
<li>
    <a href="../lua/" class="dropdown-item">Lua</a>
</li>
                                    
<li>
    <a href="../python/" class="dropdown-item">Python</a>
</li>
                                    
<li>
    <a href="../python_lib/" class="dropdown-item">Python Lib</a>
</li>
                                    
<li>
    <a href="../ruby/" class="dropdown-item">Ruby</a>
</li>
                                    
<li>
    <a href="../ruby_lib/" class="dropdown-item">Ruby Lib</a>
</li>
                                </ul>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">Setup</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../setup/01-base/" class="dropdown-item">系统设置</a>
</li>
                                    
<li>
    <a href="../../setup/02-base-devel/" class="dropdown-item">系统开发环境</a>
</li>
                                    
<li>
    <a href="../../setup/03-dockerfile/" class="dropdown-item">Dockerfile</a>
</li>
                                    
<li>
    <a href="../../setup/04-buildah/" class="dropdown-item">Buildah</a>
</li>
                                    
<li>
    <a href="../../setup/05-bootcd/" class="dropdown-item">BootCD</a>
</li>
                                    
<li>
    <a href="../../setup/06-diskimage/" class="dropdown-item">DiskImage</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ms-md-auto">
                            <li class="nav-item">
                                <a rel="prev" href="../groovy/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../java_lib/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="https://github.com/slackman-cn/www.git" class="nav-link">
                                  <i class="fa-brands fa-github"></i> 
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-bs-toggle="collapse" data-bs-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-body-tertiary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-bs-level="2"><a href="#install" class="nav-link">Install</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-bs-level="2"><a href="#_1" class="nav-link">模块化</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-bs-level="2"><a href="#jlink-jpackage" class="nav-link">jlink &amp; jpackage</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-bs-level="2"><a href="#_2" class="nav-link">多线程</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-bs-level="2"><a href="#_3" class="nav-link">单例模式</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-bs-level="2"><a href="#_4" class="nav-link">单元测试</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-bs-level="2"><a href="#logging" class="nav-link">日志 logging 内置模块</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-bs-level="2"><a href="#logback-spring" class="nav-link">日志 logback (Spring默认)</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-bs-level="2"><a href="#about" class="nav-link">About</a>
              <ul class="nav flex-column">
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h2 id="install">Install</h2>
<p>https://injdk.cn/    </p>
<p>https://jdk.java.net/archive/</p>
<p>https://hollischuang.github.io/toBeTopJavaer/</p>
<pre><code>JDK8  (2014)
 - Lambda 表达式
 - 方法引用
 - 默认方法
 - Stream API
 - Data Time API
 - Optional类

System.setProperty(&quot;jna.debug_load&quot;, &quot;true&quot;);
System.out.println(&quot;JNA Loaded: &quot; + System.getProperty(&quot;jna.loaded&quot;));
System.out.println(&quot;当前日期: &quot; + LocalDateTime.now());
System.out.println(&quot;操作系统: &quot; + System.getProperty(&quot;os.name&quot;));
System.out.println(&quot;系统版本: &quot; + System.getProperty(&quot;os.version&quot;));
System.out.println(&quot;系统架构: &quot; + System.getProperty(&quot;os.arch&quot;));
System.out.println(&quot;tmpdir java: &quot; + System.getProperty(&quot;java.io.tmpdir&quot;));
System.out.println(&quot;tmpdir jna : &quot; + System.getProperty(&quot;jna.tmpdir&quot;));
...
System.out.println(&quot;JNA Loaded: &quot; + System.getProperty(&quot;jna.loaded&quot;));
</code></pre>
<h2 id="_1">模块化</h2>
<p>https://zhuanlan.zhihu.com/p/142697835</p>
<p>class是jvm最小可执行文件，jar文件是管理class文件的容器</p>
<p>javac Hello.java  &amp;&amp;  java Hello</p>
<pre><code>java -jar hello.jar
java --module-path hello.jar --module first


class: 属性、方法集合
package: class集合
module: package集合

基础模块 java.base
java --list-modules
java --describe-module java.base

========= module-info.class（放在 java 目录）
module example.first {
    requires java.base; // 可不写，任何模块都会自动引入java.base
    requires java.xml;
}
</code></pre>
<p>模块优点</p>
<pre><code>解决依赖关系，module-info.class
JVM标准库rt.jar 已经拆分为几十个模块，位置${JAVA_HOME}/jmods/*.jmod
java.base根模块，可不写

class封装为jar只需要打包
class封装为jmod不但要打包，还要写入依赖关系，可以包含二进制代码 

// 编译src所有java文件，存放在bin目录
javac -d build src/module-info.java src/com/*.java

// package jar
jar --create --file hello.jar --main-class com.Hello -C build .

// package jmod
jmod create --class-path hello.jar hello.jmod

========== java9之前
Java程序生成自己的jar文件
第三方jar包
Java标准库 rt.jar

// jvm标准库不需要写到classpath
java -cp myapp.jar:a.jar:b.jar com.example.App

// 缺点
少个某个jar抛异常ClassNotFoundException，原因是jar只是存放class的容器，不关心依赖
</code></pre>
<h2 id="jlink-jpackage">jlink  &amp;  jpackage</h2>
<p>https://www.baeldung.com/jlink</p>
<p>https://dev.java/learn/creating-runtime-and-application-images-with-jlink/</p>
<p>https://www.devdungeon.com/content/how-create-java-runtime-images-jlink</p>
<pre><code>jlink --module-path hello.jmod --add-modules java.base,first --output jre/

打包jre (精简)
jlink --launcher myapp=first/com.Hello \
 --strip-debug --compress 2 --no-header-files --no-man-pages \
 --module-path hello.jmod --add-modules java.base,first --output jre2/

jlink 减小体积
--strip-debug
--compress 2
--no-header-files
--no-man-pages

========= 运行
jre/bin/java --module first
jre/bin/java -m first
jre2/bin/myapp
</code></pre>
<p>打包 jpackage</p>
<p>Linux: rpmutil, dpkg, fakeroot</p>
<p>Windows: WixToolset</p>
<p>macOS：XCode command line tools</p>
<pre><code>jpackage --runtime-image customjre --module first/com.company.Main

jpackage --runtime-image jre2 --type app-image --name JFX  --module first/com.Hello
--moudle 模块的名字,相当于以前的Main函数的格式,这里换成了模块 '包名'/Main函数名

实际命令
Command line was: /bin/sh -c /usr/jvm/jdk-17.0.1/bin/jpackage --name TreeFX \
 --dest /app/target/dist \
 --type app-image \
 --app-version 1.0.0 \
 --runtime-image /app/target/treefx \
 --vendor org.acme \
 --module treefx/com.acme.treefx.TreeFX \
 --icon /app/duke.png \
 --java-options -Dfile.encoding=UTF-8 \
 --linux-package-name treefx \
 --linux-menu-group Utilities \
 --linux-app-category Utilities \
 --linux-shortcut
</code></pre>
<h2 id="_2">多线程</h2>
<p>• 通过实现 Runnable 接口<br />
• 通过继承  Thread 类本身<br />
• 通过 Callable 和 Future 创建线程。  </p>
<pre><code>new MyThread().start();
new Thread(new MyRunnable()).start();
重写 public void run();

=====
FutureTask&lt;String&gt; task = new FutureTask&lt;&gt;(new Callable&lt;String&gt;() {
    @Override
    public String call() throws Exception {
        return &quot;hello&quot;;
    }
});

// 使用Future获得异步执行结果时，要么调用阻塞方法get()，要么轮询看isDone()是否为true
// 主线程也会被迫等待
new Thread(task).start();
try {
    String res = task.get();
    System.out.println(res);
} catch (InterruptedException | ExecutionException e) {
    throw new RuntimeException(e);
}
</code></pre>
<p>CompletableFuture  (JDK8)  回调方法</p>
<pre><code>// 创建异步任务
CompletableFuture&lt;Double&gt; cf = CompletableFuture.supplyAsync(() -&gt; {
    try {
        Thread.sleep(100);
    } catch (InterruptedException e) {}
    if (Math.random() &lt; 0.3) {
        throw new RuntimeException(&quot;fetch price failed!&quot;);
    }
    return 5 + Math.random() * 20;
});
// 执行成功
cf.thenAccept((result) -&gt; {
    System.out.println(&quot;price: &quot; + result);
});
// 执行异常
cf.exceptionally((e) -&gt; {
    e.printStackTrace();
    return null;
});
// 主线程不要立刻结束，否则CompletableFuture默认使用的线程池会立刻关闭:
Thread.sleep(200);
</code></pre>
<p>Thread Pool</p>
<pre><code>ExecutorService es = Executors.newFixedThreadPool(10);

//执行线程操作
// es.execute(...); 适合Runnable
// es.submit(...);  适合Callable

//关闭线程池
es.shutdown();

============ SYNC
LongAdder adder = new LongAdder();
es.execute(() -&gt; {
    adder.increment();
    log.info(&quot;sub job {}&quot;, adder.intValue());
});

============= Share
ThreadLocal&lt;User&gt; threadLocalUser = new ThreadLocal&lt;&gt;();
threadLocalUser.set(user);
User u = threadLocalUser.get();
threadLocalUser.remove();
</code></pre>
<p>Virtual Thread  (JDK 19/21)</p>
<p>https://liaoxuefeng.com/books/java/threading/virtual-thread/index.html </p>
<pre><code>ExecutorService es = Executors.newVirtualThreadPerTaskExecutor();
es.submit(...);

// 传入Runnable并立刻运行:
Thread vt = Thread.startVirtualThread(() -&gt; {
    System.out.println(&quot;Start virtual thread...&quot;);
    Thread.sleep(10);
    System.out.println(&quot;End virtual thread.&quot;);
});
</code></pre>
<h2 id="_3">单例模式</h2>
<pre><code>private static final AtomicReference&lt;SingleInstance&gt; _instance = new AtomicReference&lt;&gt;();

private SingleInstance() {
}

public static SingleInstance INSTANCE() {
    while(_instance.get() == null) {
        _instance.compareAndSet(null, new SingleInstance());
    }
    return _instance.get();
}
</code></pre>
<p>test</p>
<pre><code>Thread[] threads = new Thread[1000];
CountDownLatch latch = new CountDownLatch(1);
for (int i = 0; i &lt; 1000; i++) {
    threads[i] = new Thread(() -&gt; {
        try {
            latch.await();
            System.out.println(SingleInstance.INSTANCE());
        } catch (InterruptedException e) {
            throw new RuntimeException(e);
        }
    });
}

for (int i = 0; i &lt; 1000; i++) {
    threads[i].start();
}

latch.countDown();
</code></pre>
<h2 id="_4">单元测试</h2>
<p>Junit4</p>
<pre><code>&lt;!-- https://mvnrepository.com/artifact/junit/junit --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;junit&lt;/groupId&gt;
    &lt;artifactId&gt;junit&lt;/artifactId&gt;
    &lt;version&gt;4.13&lt;/version&gt;
    &lt;scope&gt;test&lt;/scope&gt;
&lt;/dependency&gt;

Junit4中的@Test是import org.junit.Test;
@BeforeAll, @BeforeEach, @AfterAll, @AfterEach, @Disabled
</code></pre>
<p>Junit5</p>
<pre><code>&lt;dependency&gt;
    &lt;groupId&gt;org.junit.jupiter&lt;/groupId&gt;
    &lt;artifactId&gt;junit-jupiter&lt;/artifactId&gt;
    &lt;version&gt;5.10.2&lt;/version&gt;
&lt;/dependency&gt;

&lt;!-- https://mvnrepository.com/artifact/org.junit.jupiter/junit-jupiter-api --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.junit.jupiter&lt;/groupId&gt;
    &lt;artifactId&gt;junit-jupiter-api&lt;/artifactId&gt;
    &lt;version&gt;5.7.2&lt;/version&gt;
    &lt;scope&gt;test&lt;/scope&gt;
&lt;/dependency&gt;

Jupiter中的@Test是import org.junit.jupiter.api.Test;
@BeforeClass, @Before, @AfterClass, @After, @Ignore
</code></pre>
<p>env</p>
<pre><code>========== 断言
assertEquals(expected, actual)
assertTrue(booleanExpression)
assertFalse(booleanExpression)
assertNull(actual)
assertNotNull(actual)

=========== 其他注解
@DisplayName(&quot;It tests the length of student name should less than 10 chars&quot;)

BusinessException businessException = Assertions.
   assertThrows(BusinessException.class, this::buildStudentDescription);

=========== 设置环境变量
https://junit-pioneer.org/docs/system-properties/
&lt;!-- https://mvnrepository.com/artifact/org.junit-pioneer/junit-pioneer --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.junit-pioneer&lt;/groupId&gt;
    &lt;artifactId&gt;junit-pioneer&lt;/artifactId&gt;
    &lt;version&gt;1.4.2&lt;/version&gt;
    &lt;scope&gt;test&lt;/scope&gt;
&lt;/dependency&gt;

@SetSystemProperty(key = &quot;jna.debug_load&quot;, value = &quot;true&quot;)
@SetSystemProperty(key = &quot;jna.library.path&quot;, value = &quot;C:\\jna&quot;)
</code></pre>
<h2 id="logging">日志 logging 内置模块</h2>
<pre><code>System.setProperty(&quot;java.util.logging.SimpleFormatter.format&quot;,
    &quot;[%1$tF %1$tT] [%4$-2s] %5$s %n&quot;);

Logger log = Logger.getGlobal();
FileHandler fileHandler = new FileHandler(&quot;app.log&quot;);
fileHandler.setFormatter(new SimpleFormatter());  
log.addHandler(fileHandler);

log.info(&quot;hello&quot;);
log.info(&quot;hello2&quot;);
</code></pre>
<p>参考</p>
<pre><code>https://www.logicbig.com/tutorials/core-java-tutorial/logging/customizing-default-format.html
https://geekdaxue.co/read/xinblog@javalog/itkt7t
https://zhuanlan.zhihu.com/p/505339189

System.setProperty(&quot;java.util.logging.SimpleFormatter.format&quot;,
    &quot;[%1$tT %1$tL] %5$s %n&quot;);
</code></pre>
<h2 id="logback-spring">日志 logback (Spring默认)</h2>
<pre><code>private static final Logger log = LoggerFactory.getLogger(App1.class);
log.info(&quot;hello {}&quot;, 123);

&lt;dependency&gt;
    &lt;groupId&gt;ch.qos.logback&lt;/groupId&gt;
    &lt;artifactId&gt;logback-classic&lt;/artifactId&gt;
    &lt;version&gt;1.5.6&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>
<p>logback.xml</p>
<pre><code>&lt;configuration&gt;
    &lt;appender name=&quot;STDOUT&quot; class=&quot;ch.qos.logback.core.ConsoleAppender&quot;&gt;
        &lt;encoder&gt;
            &lt;pattern&gt;%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n&lt;/pattern&gt;
        &lt;/encoder&gt;
    &lt;/appender&gt;
    &lt;appender name=&quot;FILE&quot; class=&quot;ch.qos.logback.core.FileAppender&quot;&gt;
        &lt;file&gt;tests.log&lt;/file&gt;
        &lt;append&gt;true&lt;/append&gt;
        &lt;encoder&gt;
            &lt;pattern&gt;%-4relative [%thread] %-5level %logger{35} - %msg%n&lt;/pattern&gt;
        &lt;/encoder&gt;
    &lt;/appender&gt;

    &lt;root level=&quot;debug&quot;&gt;
        &lt;appender-ref ref=&quot;STDOUT&quot; /&gt;
        &lt;appender-ref ref=&quot;FILE&quot; /&gt;
    &lt;/root&gt;
&lt;/configuration&gt;
</code></pre>
<h2 id="about">About</h2>
<p>logback.xml</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;configuration&gt;

    &lt;property name=&quot;LOGS&quot; value=&quot;./logs&quot; /&gt;

    &lt;appender name=&quot;Console&quot;
              class=&quot;ch.qos.logback.core.ConsoleAppender&quot;&gt;
        &lt;layout class=&quot;ch.qos.logback.classic.PatternLayout&quot;&gt;
            &lt;Pattern&gt;
                %black(%d{ISO8601}) %highlight(%-5level) [%blue(%t)] %yellow(%C{1.}): %msg%n%throwable
            &lt;/Pattern&gt;
        &lt;/layout&gt;
    &lt;/appender&gt;

    &lt;appender name=&quot;RollingFile&quot;
              class=&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;&gt;
        &lt;file&gt;${LOGS}/spring-boot-logger.log&lt;/file&gt;
        &lt;encoder
                class=&quot;ch.qos.logback.classic.encoder.PatternLayoutEncoder&quot;&gt;
            &lt;Pattern&gt;%d %p %C{1.} [%t] %m%n&lt;/Pattern&gt;
        &lt;/encoder&gt;

        &lt;rollingPolicy
                class=&quot;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&quot;&gt;
            &lt;!-- rollover daily and when the file reaches 10 MegaBytes --&gt;
            &lt;fileNamePattern&gt;${LOGS}/archived/spring-boot-logger-%d{yyyy-MM-dd}.%i.log
            &lt;/fileNamePattern&gt;
            &lt;timeBasedFileNamingAndTriggeringPolicy
                    class=&quot;ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP&quot;&gt;
                &lt;maxFileSize&gt;10MB&lt;/maxFileSize&gt;
            &lt;/timeBasedFileNamingAndTriggeringPolicy&gt;
        &lt;/rollingPolicy&gt;
    &lt;/appender&gt;

    &lt;!-- LOG everything at INFO level --&gt;
    &lt;root level=&quot;info&quot;&gt;
        &lt;appender-ref ref=&quot;RollingFile&quot; /&gt;
        &lt;appender-ref ref=&quot;Console&quot; /&gt;
    &lt;/root&gt;

    &lt;!-- LOG &quot;com.baeldung*&quot; at TRACE level --&gt;
    &lt;logger name=&quot;com.baeldung&quot; level=&quot;trace&quot; additivity=&quot;false&quot;&gt;
        &lt;appender-ref ref=&quot;RollingFile&quot; /&gt;
        &lt;appender-ref ref=&quot;Console&quot; /&gt;
    &lt;/logger&gt;

&lt;/configuration&gt;
</code></pre>
<p>DemoApplication.java</p>
<pre><code>package com.example.demo;

import lombok.extern.slf4j.Slf4j;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.beans.factory.annotation.Value;
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.boot.system.ApplicationHome;
import org.springframework.core.convert.Property;
import org.springframework.core.io.ClassPathResource;
import org.springframework.util.ResourceUtils;

import javax.annotation.PostConstruct;
import java.io.File;
import java.io.FileNotFoundException;
import java.io.IOException;
import java.net.URL;
import java.nio.file.Path;
import java.util.Arrays;
import java.util.Collections;
import java.util.Properties;

@SpringBootApplication
@Slf4j
public class DemoApplication {

    public static void main(String[] args) {
//      ApplicationHome home = new ApplicationHome(DemoApplication.class);
//      if (home.getSource().getAbsolutePath().endsWith(&quot;jar&quot;)) {
//          String[] newArgs = new String[args.length + 1];
//          System.arraycopy(args, 0, newArgs, 0, args.length);
//          newArgs[args.length] = &quot;-Dlogging.file.path=&quot; + home.getSource().getParent();
//          args = newArgs;
//          String logPath = System.getProperty(&quot;-Dlogging.file.path&quot;);
//          System.out.println(logPath);
//          System.setProperty(&quot;-Dlogging.file.path&quot;, home.getSource().getParent());
//      }

//      try {
//          Properties prop = new Properties();
//          prop.load(DemoApplication.class.getClassLoader().getResourceAsStream(&quot;application.properties&quot;));
//          System.out.println(prop);
//      } catch (IOException e) {
//
//      }

//      ClassPathResource r = new ClassPathResource(&quot;application.properties&quot;);
//
//      String logPath = System.getProperty(&quot;-Dlogging.file.path&quot;);
//      System.out.println(logPath);
        ApplicationHome home = new ApplicationHome(DemoApplication.class);
        SpringApplication app = new SpringApplication(DemoApplication.class);
        app.setDefaultProperties(Collections.singletonMap(&quot;logging.file.path&quot;, home.getSource().getParent()));
        app.run(args);

//      SpringApplication.run(DemoApplication.class, args);
    }

    Logger LOG = LoggerFactory.getLogger(DemoApplication.class);

//  @Value(&quot;${user.dir}&quot;)
//  private Object dir;
//
    @Value(&quot;${logging.file.path}&quot;)
    private String path;

//  @Value(&quot;${server.port}&quot;)
//  private String port;

    @PostConstruct
    public void init() {
//      URL url = ResourceUtils.getURL(&quot;&quot;);
//      System.out.println(url);

//      File file = ResourceUtils.getFile(&quot;classpath:application.properties&quot;);
//      System.out.println(file.toURI());

//      ClassPathResource r = new ClassPathResource(&quot;application.properties&quot;);
//      System.out.println(r.getURL());
//      System.out.println(r.getURI());
//      Path path = Path.of(r.getURI());
//      System.out.println(path);

//      File file = new File(&quot;.&quot;);
//      System.out.println(file.isDirectory());
//      System.out.println(file.getAbsolutePath());

        System.out.println(&quot;---------get log path----------&quot;);
        System.out.println(path);
//      ApplicationHome home = new ApplicationHome(this.getClass());
//      System.out.println(home.getSource().getAbsolutePath());
//      System.out.println(home.getSource().getParent());
//      System.out.println(home.getSource().getPath());
//      LOG.info(home.getSource().getParent());
//      System.out.println(dir);
    }
}

</code></pre></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="../../js/bootstrap.bundle.min.js"></script>
        <script src="../../js/base.js"></script>

    </body>
</html>
